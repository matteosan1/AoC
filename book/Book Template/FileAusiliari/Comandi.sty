%%%%%						Caratteri
\newcommand{\A}{\mathbb{A}}
\renewcommand{\AA}{\mathcal{A}}
\newcommand{\AAA}{\mathscr{A}}

\newcommand{\B}{\mathbb{B}}
\newcommand{\BB}{\mathcal{B}}	
\newcommand{\BBB}{\mathscr{B}}

\newcommand{\C}{\mathbb{C}}
\newcommand{\CC}{\mathcal{C}}	
\newcommand{\CCC}{\mathscr{C}}

\newcommand{\D}{\mathbb{D}}
\newcommand{\DD}{\mathcal{D}}
\newcommand{\DDD}{\mathscr{D}}

\newcommand{\E}{\mathbb{E}}
\newcommand{\EE}{\mathcal{E}}
\newcommand{\EEE}{\mathscr{E}}

\newcommand{\F}{\mathbb{F}}
\newcommand{\FF}{\mathcal{F}}
\newcommand{\FFF}{\mathscr{F}}

\newcommand{\G}{\mathbb{G}}
\newcommand{\GG}{\mathcal{G}}
\newcommand{\GGG}{\mathscr{G}}

\renewcommand{\H}{\mathbb{H}}	
\newcommand{\HH}{\mathcal{H}}	
\newcommand{\HHH}{\mathscr{H}}

\newcommand{\I}{\mathbb{I}}
\newcommand{\II}{\mathcal{I}}	
\newcommand{\III}{\mathscr{I}}

\newcommand{\J}{\mathbb{J}}
\newcommand{\JJ}{\mathcal{J}}	
\newcommand{\JJJ}{\mathscr{J}}

\newcommand{\K}{\mathbb{K}}
\newcommand{\KK}{\mathcal{K}}	
\newcommand{\KKK}{\mathscr{K}}

\renewcommand{\L}{\mathbb{L}}	
\newcommand{\LL}{\mathcal{L}}	
\newcommand{\LLL}{\mathscr{L}}

\newcommand{\M}{\mathbb{M}}
\newcommand{\MM}{\mathcal{M}}	
\newcommand{\MMM}{\mathscr{M}}

\newcommand{\N}{\mathbb{N}}
\newcommand{\NN}{\mathcal{N}}
\newcommand{\NNN}{\mathscr{N}}

\renewcommand{\O}{\mathbb{O}}	
\newcommand{\OO}{\mathcal{O}}	
\newcommand{\OOO}{\mathscr{O}}

\renewcommand{\P}{\mathbb{P}}	
\newcommand{\PP}{\mathcal{P}}	
\newcommand{\PPP}{\mathscr{P}}

\newcommand{\Q}{\mathbb{Q}}
\newcommand{\QQ}{\mathcal{Q}}	
\newcommand{\QQQ}{\mathscr{Q}}

\newcommand{\R}{\mathbb{R}}
\newcommand{\RR}{\mathcal{R}}	
\newcommand{\RRR}{\mathscr{R}}

\renewcommand{\S}{\mathbb{S}}	
\renewcommand{\SS}{\mathcal{S}}
\newcommand{\SSS}{\mathscr{S}}

\newcommand{\T}{\mathbb{T}}
\newcommand{\TT}{\mathcal{T}}	
\newcommand{\TTT}{\mathscr{T}}

\newcommand{\U}{\mathbb{U}}
\newcommand{\UU}{\mathcal{U}}	
\newcommand{\UUU}{\mathscr{U}}

\newcommand{\V}{\mathbb{V}}
\newcommand{\VV}{\mathcal{V}}
\newcommand{\VVV}{\mathscr{V}}

\newcommand{\W}{\mathbb{W}}
\newcommand{\WW}{\mathcal{W}}	
\newcommand{\WWW}{\mathscr{W}}

\newcommand{\X}{\mathbb{X}}
\newcommand{\XX}{\mathcal{X}}
\newcommand{\XXX}{\mathscr{X}}

\newcommand{\Y}{\mathbb{Y}}
\newcommand{\YY}{\mathcal{Y}}	
\newcommand{\YYY}{\mathscr{Y}}

\newcommand{\Z}{\mathbb{Z}}
\newcommand{\ZZ}{\mathcal{Z}}
\newcommand{\ZZZ}{\mathscr{Z}}


%%%%%						Margini e note
\newcommand{\note}[1]{\marginpar{\smallnote\normalfont #1}}
\newcommand{\expl}[1]{\marginpar{\color{orange!90!black}\smallnote\normalfont #1}}

%%%%%						Simboli
\renewcommand{\d}[0]{\text{d}}
\newcommand{\e}{\text{\normalfont e}}
\renewcommand{\epsilon}{\varepsilon}
\renewcommand{\exp}{\text{\normalfont exp}}
\newcommand{\f}[0]{\textsl{f}}
\newcommand{\g}[0]{\textsl{g}}
\renewcommand{\i}{\imath}
\newcommand{\Id}[1]{\normalfont{\text{Id}}_{#1}}
\renewcommand{\j}{\jmath}
\renewcommand{\l}[0]{\textsl{l}}
\renewcommand{\phi}{\varphi}
\newcommand{\sbullet}{\text{\footnotesize $\bullet$}}
\renewcommand{\theta}{\vartheta}
\renewcommand{\v}[0]{\textsl{v}}
\newcommand{\Zero}[0]{{\boldsymbol{0}}}

%%%%%						Operatori
\renewcommand{\*}{\cdot}
\newcommand{\CF}[2]{\left\langle#1,#2\right\rangle}
\newcommand{\codim}[2]{\text{\normalfont codim}_{\hspace{0.05cm}#2}{\ #1}}
\newcommand{\Dif}[2]{\text{\normalfont d}\Set{#1}_{#2}}
\newcommand{\Diff}[2]{\text{d}{#1}_{#2}}
\newcommand{\Floor}[1]{\left\lfloor #1 \right\rfloor}
\newcommand{\Imm}[1]{\mathfrak{I}\left(#1\right)}
\newcommand{\Leg}[2]{\genfrac{(}{)}{}{}{#1}{#2}}
\newcommand{\nobarfrac}{\genfrac{}{}{0pt}{}}
\newcommand{\Norma}[1]{\left\|#1\right\|}
\newcommand{\Lie}[2]{\left[{#1},{#2}\right]}
\newcommand{\PS}[2]{\left(#1,#2\right)}
\newcommand{\Rad}[1]{\text{\normalfont Rad}\left(#1\right)}
\renewcommand{\Re}[1]{\normalfont{\text{Re}}\left(#1\right)}
\newcommand{\Res}[2]{\left.#1\right|_{#2}}
\newcommand{\Stirling}[2]{\left[\nobarfrac{#1}{#2}\right]}
\newcommand{\SStirling}[2]{\genfrac{\{}{\}}{0pt}{0}{\displaystyle #1}{\displaystyle #2}} 
\newcommand{\Val}[2]{\left.#1\right|_{#2}}
\renewcommand{\binom}[2]{\left(\genfrac{}{}{0pt}{0}{#1}{#2}\right)}

%%%%%						Insiemi
\newcommand{\Ann}[1]{\text{\normalfont Ann}\left(#1\right)}
\newcommand{\Aut}[1]{\normalfont{\text{Aut}}\left(#1\right)}
\newcommand{\Fix}[1]{\normalfont{\text{Fix}}\left(#1\right)}
\newcommand{\GAut}[1]{\normalfont{\text{Gal}}\left(#1\right)}
\newcommand{\GL}[2]{\normalfont{\text{GL}}\left(#1,#2\right)}
\newcommand{\GLE}[1]{\text{\normalfont GL}\left(#1\right)}
\newcommand{\Hom}[3]{\text{\normalfont Hom}_{#3}\left(#1,#2\right)}
\newcommand{\Ker}[1]{\normalfont{\text{Ker}}\ {#1}}
\newcommand{\OM}[2]{\normalfont{\text{O}}\left(#1,#2\right)}
\newcommand{\Seq}[3]{\left\{{#1}_{#2}\right\}_{#2\in#3}}
\newcommand{\Set}[1]{\left\{#1\right\}}
\newcommand{\SLM}[2]{\normalfont{\text{SL}}\left(#1,#2\right)}
\newcommand{\SO}[2]{\normalfont{\text{SO}}\left(#1,#2\right)}
\newcommand{\Span}[1]{\text{Span}\left(#1\right)}
\newcommand{\SU}[2]{\normalfont{\text{SU}}\left(#1,#2\right)}
\newcommand{\Stab}[2]{\text{Stab}_{#2}{#1}}
\newcommand{\TM}[2]{\normalfont{\text{T}}\left(#1,#2\right)}
\newcommand{\Tr}[1]{\text{\normalfont Tr}\left(#1\right)}
\newcommand{\UM}[2]{\normalfont{\text{U}}\left(#1,#2\right)}

%%%%%						Equazioni
\newtagform{squarebrackets}[\textbf]{[}{]}
\usetagform{squarebrackets}	% Cambia le parentesi dei label
\newcommand{\EqL}[2]{\begin{align}\label{#2}#1\end{align}}
\newcommand{\Eq}[1]{\begin{align}#1\end{align}}

%%%%%						Mappe
	\newcommand{\Map}[5]{
		\begin{array}{rrcl}
			#1:\quad&#2&\to&#3\\
			&#4&\mapsto&#5
		\end{array}}
		
	\newcommand{\NMap}[4]{
		\begin{array}{rcl}
			#1&\to & #2\\
			#3&\mapsto & #4
		\end{array}}

%%%%%						Minipage
	\newcommand{\Minipage}[4]{\noindent 					% Evita overfull
		\begin{minipage}[l]{#1\textwidth}{#2}\end{minipage}
			\hfill
		\begin{minipage}[r]{#3\textwidth}{#4}\end{minipage}		%Lo spazio sotto manda a capo

    \noindent}
    
%%%%%						Citazioni
\newcommand{\Quote}[3]{
	\Minipage
		{.5}{}{#3}{\RiquadroOmbra	{
			\say{\it #1}\begin{flushright}#2\end{flushright}
		}}}

%%%%%						Figure in pagine pari/dispari
\newcommand{\EvOdd}[3]{
	\ifnumodd{\thepage}
		{\begin{wrapfigure}[#1]{r}{#2}{#3}\end{wrapfigure}}
		{\begin{wrapfigure}[#1]{l}{#2}{#3}\end{wrapfigure}}}

%%%%%						Overline (come overline, ma con la barra un po' pi√π sollevata)
\newcommand{\Overline}[1]{\overline{\raisebox{0pt}[\dimexpr\height+.25mm\relax]{$#1$}}}

%%%%%						Simboli carte da gioco
\makeatletter
	\DeclareSymbolFont{extraup}{U}{zavm}{m}{n}
	\DeclareMathSymbol{\varheart}{\mathalpha}{extraup}{86}
	\DeclareMathSymbol{\vardiamond}{\mathalpha}{extraup}{87}
\makeatother

%%%%%						Soluzione alternativa
\newcommand{\Alternativa}[0]{\begin{center}{\bf\Large\underline{Soluzione alternativa}}\end{center}}

%%%%%						Bilanciamento ( )
\makeatletter
	\def\resetMathstrut@{
		\setbox\z@\hbox{
			\mathchardef\@tempa\mathcode`\[\relax
			\def\@tempb##1"##2##3{\the\textfont"##3\char"}
			\expandafter\@tempb\meaning\@tempa\relax}
		\ht\Mathstrutbox@\ht\z@ \dp\Mathstrutbox@\dp\z@}
\makeatother

\begingroup
	\catcode`(\active \xdef({\left\string(}
	\catcode`)\active \xdef){\right\string)}
\endgroup
\mathcode`(="8000 \mathcode`)="8000

%%%%%						Nascondere dall'indice
\newcounter{Counter}
\newcommand{\Nascondi}{\setcounter{Counter}{\value{tocdepth}}
	\addtocontents{toc}{\protect\setcounter{tocdepth}{-10}}}
\newcommand{\Mostra}{\addtocontents{toc}{\protect\setcounter{tocdepth}{1}}}

%%%%%						Puntini in basso
\renewcommand{\dots}[0]{\hdots}

% Per i wrapping delle figure dentro ambienti theorem (preso da https://ctan.org/insbox): sono disponibili
%\InsertBoxL{numero righe sopra}{Codice immagine}[numero righe sotto]
%\InsertBoxC{numero righe sopra}{Codice immagine}[numero righe sotto]
%\InsertBoxR{numero righe sopra}{Codice immagine}[numero righe sotto]

%%%%%						Geometria
\newcommand{\overarc}[1]{\ooalign{\hfil\scalebox{0.9}{$#1$}\cr\hfil\raisebox{5pt}{\rotatebox{90}{\scalebox{1}{$\left.\right)$}}}\hfil\cr}}
\newcommand{\Seg}[1]{\Overline{#1}}
\newcommand{\Punto}[3]{\addplot[mark=*, #3] coordinates {(#1,#2)};}
\newcommand{\Puntotre}[4]{\addplot[mark=*, #4] coordinates {(#1,#2,#3)};}
\newcommand{\Segmento}[5]{\addplot[#5] coordinates {(#1,#2) (#3,#4)};}
\newcommand{\Grafico}[4]{\addplot[domain=#1:#2, #4] {#3};}
	%%%%%			Per la lunghezza di un segmento in evidenza
\newcommand{\SegmentInfo}[5]{\pgfkeys{/pgf/number format/.cd,fixed,precision=2}\begin{scope}[dim style/.style={#3}]
								\tkzDrawSegment[dim={{\hspace{.05cm} #4\hspace{.1cm} },#5,}](#1,#2)
								\end{scope}}

%%%%%						Box

%%%%%						Riquadro Ombra
\newcommand{\RiquadroOmbra}[1]{
	\tcbset{enhanced, colback=gray!15, boxrule=0pt, colframe=white,
		fonttitle=\bfseries}
	\begin{tcolorbox}[lifted shadow={1mm}{-2mm}{2mm}{0.1mm}
		{black!50!white}]#1
	\end{tcolorbox}}
	
%%%%%						Riquadro Titolo Libro (per il colore, mettere [colbacktitle=] 	nel documento dopo \begin{TitoloIntro})
\newtcolorbox{TitoloIntro}[2][]{
	enhanced, width=\dimexpr\textwidth+25pt+45pt, before skip=2mm, after skip=2mm,
	colback=black!5, colframe=white, boxrule=0mm, attach boxed title to top left={xshift=.5cm, yshift*=1mm-\tcboxedtitleheight},
	varwidth boxed title*=-2cm,
	boxed title style={frame code={
			\path[fill=tcbcolback!80!black]
			([yshift=-1mm, xshift=-1mm]frame.north west)
			arc[start angle=0, end angle=180, radius=1mm]
			([yshift=-1mm, xshift=1mm]frame.north east)
			arc[start angle=180, end angle=0,radius=1mm];
			\path[top color=tcbcolback, middle color=tcbcolback!90, bottom color = tcbcolback!40!white]
			([xshift=-2mm]frame.north west) --
						([xshift=2mm]frame.north east)
			[rounded corners=1mm] -- ([xshift=1mm, yshift=-1mm]frame.north east)
			-- (frame.south east) -- (frame.south west)
			-- ([xshift=-1mm, yshift=-1mm]frame.north west)
			[sharp corners]-- cycle;
			}, interior engine=empty},
	fonttitle=\bfseries,
	title={#2},#1}

\newtcolorbox{RTitoloIntro}[2][]{
	enhanced, before skip=2mm, after skip=2mm,
	colback=black!5, colframe=white, boxrule=0mm, attach boxed title to top right={xshift=-.5cm, yshift*=1mm-\tcboxedtitleheight},
	varwidth boxed title*=2cm,
	boxed title style={frame code={
			\path[fill=tcbcolback!80!black]
			([yshift=-1mm, xshift=-1mm]frame.north west)
			arc[start angle=0, end angle=180, radius=1mm]
			([yshift=-1mm, xshift=1mm]frame.north east)
			arc[start angle=180, end angle=0, radius=1mm];
			\path[top color=tcbcolback, middle 
				color=tcbcolback!90, bottom color=tcbcolback!40!white]
			([xshift=-2mm]frame.north west) --
						([xshift=2mm]frame.north east)
			[rounded corners=1mm] --([xshift=1mm, yshift=-1mm]frame.north east)
			-- (frame.south east) -- (frame.south west)
			-- ([xshift=-1mm, yshift=-1mm]frame.north west)
			[sharp corners]-- cycle;
			}, interior engine=empty},
	fonttitle=\bfseries,
	title={#2},#1}